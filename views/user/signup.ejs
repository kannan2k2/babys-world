<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Signup Form</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <style>
        * {
            box-sizing: border-box;
        }

        body {
            background-color: rgb(255, 254, 254);
            margin: 0;
            font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
        }

        h1 {
            color: #c28282;
            text-align: center;
            margin: 0;
            margin-bottom: 10px;
        }

        form {
            width: 400px;
            background-color: rgba(255, 255, 255, 1);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0px 0px 10px #fff;
        }

        .form-control:focus {
            outline: none;
            border-color: #394867;
            transition: .3s;
        }

        .btn {
            border: none;
            background-color: #394867;
            color: #fff;
            width: 100%;
            padding: 10px;
            border-radius: 5px;
            transition: background-color 0.3s ease;
        }

        .btn:hover {
            background-color: #4b744d;
        }

        .alert {
            display: none;
            margin-bottom: 20px;
        }

        .is-invalid {
            border-color: #e3342f;
        }

        .password-strength {
            margin-top: 10px;
            text-align: center;
        }

        .strength-weak {
            color: #e3342f;
        }

        .strength-medium {
            color: #ffcc00;
        }

        .strength-strong {
            color: #4b744d;
        }
    </style>
</head>
<body>
    <form name="signupForm" class="form" action="/signupost" method="post" onsubmit="return validateForm()">
        <h1>SIGN UP</h1>

        <div id="alert-placeholder" class="alert alert-danger" role="alert">
            Please correct the errors in the form.
        </div>

        <div class="form-group">
            <label for="firstname">First Name</label>
            <input type="text" class="form-control" id="firstname" placeholder="First Name" name="firstname" />
        </div>

        <div class="form-group">
            <label for="lastname">Last Name</label>
            <input type="text" class="form-control" id="lastname" placeholder="Last Name" name="lastname" />
        </div>

        <div class="form-group">
            <label for="email">E-Mail</label>
            <input type="email" class="form-control" id="email" placeholder="example@example.com" name="email" />
        </div>

        <div class="form-group">
            <label for="password">Password</label>
            <input type="password" class="form-control" id="password" placeholder="Password" name="password" oninput="checkPasswordStrength()" />
            <div id="password-strength" class="password-strength"></div>
            <ul id="password-guidance" class="password-guidance"></ul>
        </div>
        

        <div class="form-group">
            <label for="referalcode">Referal Code (Optional)</label>
            <input type="text" class="form-control" id="referalcode" placeholder="Referal Code" name="referalcode" />
        </div>

        <button class="btn" type="submit">Submit</button>
    </form>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <script>
        function validateForm() {
            let isValid = true;
            let alertMessage = "";

            // Clear previous error messages
            $(".is-invalid").removeClass("is-invalid");

            // Hide previous alerts
            $("#alert-placeholder").hide();

            // Validate First Name
            const firstName = document.getElementById("firstname").value;
            if (firstName === "") {
                alertMessage += "<li>First Name is required.</li>";
                $("#firstname").addClass("is-invalid");
                isValid = false;
            }

            // Validate Last Name
            const lastName = document.getElementById("lastname").value;
            if (lastName === "") {
                alertMessage += "<li>Last Name is required.</li>";
                $("#lastname").addClass("is-invalid");
                isValid = false;
            }

            // Validate Email
            const email = document.getElementById("email").value;
            const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            const isValidEmail = emailPattern.test(email);
            const hasComDomain = email.endsWith(".com");
            if (email === "") {
                alertMessage += "<li>Email is required.</li>";
                $("#email").addClass("is-invalid");
                isValid = false;
            } else if (!isValidEmail) {
                alertMessage += "<li>Please enter a valid email address.</li>";
                $("#email").addClass("is-invalid");
                isValid = false;
            } else if (!hasComDomain) {
                alertMessage += "<li>Email must end with .com.</li>";
                $("#email").addClass("is-invalid");
                isValid = false;
            }

            // Validate Password
            const password = document.getElementById("password").value;
            if (password === "") {
                alertMessage += "<li>Password is required.</li>";
                $("#password").addClass("is-invalid");
                isValid = false;
            } else if (!checkPasswordStrength()) {
                alertMessage += "<li>Password is not strong enough.</li>";
                $("#password").addClass("is-invalid");
                isValid = false;
            }

            if (!isValid) {
                $("#alert-placeholder").html("<ul>" + alertMessage + "</ul>").show();
                setTimeout(() => {
                    $("#alert-placeholder").fadeOut();
                }, 4000);
            }

            return isValid;
        }

        function checkPasswordStrength() {
    const password = document.getElementById("password").value;
    const strengthElement = document.getElementById("password-strength");
    const guidanceElement = document.getElementById("password-guidance");
    let guidanceMessages = [];
    
    let strength = "weak";
    let strengthClass = "strength-weak";
    let strengthScore = 0;

    // Check password conditions
    if (password.length >= 8) {
        strengthScore++;
    } else {
        guidanceMessages.push("At least 8 characters required.");
    }

    if (/[A-Z]/.test(password)) {
        strengthScore++;
    } else {
        guidanceMessages.push("At least 1 uppercase letter required.");
    }

    if (/[a-z]/.test(password)) {
        strengthScore++;
    } else {
        guidanceMessages.push("At least 1 lowercase letter required.");
    }

    if (/\d/.test(password)) {
        strengthScore++;
    } else {
        guidanceMessages.push("At least 1 number required.");
    }

    if (/[@$!%*?&#]/.test(password)) {
        strengthScore++;
    } else {
        guidanceMessages.push("At least 1 special character (@, $, !, %, *, ?, &, #) required.");
    }

    // Determine the password strength based on score
    if (strengthScore >= 4) {
        strength = "strong";
        strengthClass = "strength-strong";
    } else if (strengthScore >= 3) {
        strength = "medium";
        strengthClass = "strength-medium";
    }

    // Update the password strength display
    strengthElement.textContent = `Password Strength: ${strength}`;
    strengthElement.className = `password-strength ${strengthClass}`;

    // Display guidance messages
    guidanceElement.innerHTML = guidanceMessages.map(message => `<li>${message}</li>`).join("");

    return strength === "strong";
}

    </script>
</body>
</html>
